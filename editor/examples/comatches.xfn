codata Fun(a b: Type) {
    Fun(a, b).ap(a: Type, b: Type, x: a) : b
}

codata Pi(a: Type, p: Fun(a, Type)) {
    Pi(a, p).pi_elim(a: Type, p: Fun(a, Type), x: a) : p.ap(a, Type, x)
}

data Top { Unit }

-- The identity function
def Top.id: Pi(Type, comatch _ { ap(_, _, a) => Fun(a, a) }) {
    Unit => comatch _ { pi_elim(_, _, a) => comatch _ { ap(_, _, x) => x } } : Pi(Type, comatch _ { ap(_, _, a) => Fun(a, a) })
}

-- The constant function
def Top.const: Pi(Type, comatch _ { ap(_, _, a) => Pi(Type, comatch _ { ap(_, _, b) => Fun(a, Fun(b, a)) }) }) {
    Unit => comatch _ { pi_elim(_, _, a) => comatch _ { pi_elim(_, _, b) => comatch _ { ap(_, _, x) => comatch _ { ap(_, _, y) => x } } }}
}
